<!DOCTYPE html>
<html lang="en">
	<head>
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=G-5PN516R24R"></script>
		<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'G-5PN516R24R');
		</script>
		<title>NITT Admin Block</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<link type="text/css" rel="stylesheet" href="main.css">
	</head>

	<body>
		<div id="play" class="show">
			<div>
				<div>The building is a 3D model. You can use mouse pointer(drag and rotate) or touch to move through it.</div>
				<h3>The site has Audio.</h3>
				<button id="playButton">Play</button>
			</div>
		</div>
		<div id="main" class="none">
			<div id="container"></div>
			<audio id="pride_of_india">
				<source src="./assets/sounds/pride_of_india.mp4" >
			Your browser does not support the audio element.
			</audio>
			<div id="info">
				<div id="bottom">
					<div>Made with ‚ù§ by <a href="https://priyanshudangi.github.io/" target="_blank">Priyanshu Dangi</a></div>
					<div>Loved the Project! Want to <a href="https://priyanshudangi.github.io/Virtual-NITT/virtual/contribution/index.html" target="_blank">Contribute?</a></div>
					<!-- <div>Follow me on <a href="https://www.instagram.com/priyanshu._.11/" target="_blank">Instagram</a> & <a href="https://twitter.com/PriyanshuDangi1" target="_blank">Twitter</a></div> -->
				</div>
			</div>
		</div>


		<script type="module">

			const playButton = document.getElementById("playButton");
			const play = document.getElementById("play");
			const main = document.getElementById("main");

			const pride_of_india = document.getElementById("pride_of_india");
			let consent = false;

			playButton.addEventListener('click', () => {
				play.classList.remove('show');
				play.classList.add('none');
				main.classList.remove('none');
				main.classList.add('show');
				pride_of_india.play();
				consent = true;
			})

			import * as THREE from '../build/three.module.js';

			import Stats from './jsm/libs/stats.module.js';

			import { OrbitControls } from './jsm/controls/OrbitControls.js';
			import { GLTFLoader } from './jsm/loaders/GLTFLoader.js';
			import { DRACOLoader } from './jsm/loaders/DRACOLoader.js';

			// let mixer;

			// const clock = new THREE.Clock();
			// const container = document.getElementById( 'container' );

			// const stats = new Stats();
			// container.appendChild( stats.dom );

			const renderer = new THREE.WebGLRenderer( { antialias: true } );
			renderer.setPixelRatio( window.devicePixelRatio );
			renderer.setSize( window.innerWidth, window.innerHeight );
			renderer.outputEncoding = THREE.sRGBEncoding;
			container.appendChild( renderer.domElement );

			const scene = new THREE.Scene();
			scene.background = new THREE.Color( 0xbfe3dd );

			const camera = new THREE.PerspectiveCamera( 40, window.innerWidth / window.innerHeight, 1, 100 );
			camera.position.set(0, 0, -14 );

			const controls = new OrbitControls( camera, renderer.domElement );
			controls.target.set( 0, 0, 0 );
			controls.update();
			controls.enablePan = false;
			controls.enableDamping = true;
			controls.minDistance = 7;
			controls.maxDistance = 70;

			scene.add( new THREE.HemisphereLight( 0xffffff, 0x000000, 0.4 ) );

			const dirLight = new THREE.DirectionalLight( 0xffffff, 1 );
			dirLight.position.set( 5, 2, -18 );
			scene.add( dirLight );

			// envmap
			// const path = 'textures/cube/Park2/';
			// const format = '.jpg';
			// const envMap = new THREE.CubeTextureLoader().load( [
			// 	path + 'posx' + format, path + 'negx' + format,
			// 	path + 'posy' + format, path + 'negy' + format,
			// 	path + 'posz' + format, path + 'negz' + format
			// ] );

			const dracoLoader = new DRACOLoader();
			dracoLoader.setDecoderPath( 'js/libs/draco/gltf/' );


			const loader = new GLTFLoader();
			loader.setDRACOLoader( dracoLoader );
			loader.load( 'nitt.glb', function ( gltf ) {

				const model = gltf.scene;
				model.position.set( 0, -2, 0 );
				model.scale.set( 0.6, 0.6, 0.6 );
				// model.traverse( function ( child ) {

				// 	if ( child.isMesh ) child.material.envMap = envMap;

				// } );

				scene.add( model );

				// mixer = new THREE.AnimationMixer( model );
				// mixer.clipAction( gltf.animations[ 0 ] ).play();

				animate();
				// pride_of_india.play();

			}, undefined, function ( e ) {

				console.error( e );

			} );


			window.onresize = function () {

				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();

				renderer.setSize( window.innerWidth, window.innerHeight );

			};


			function animate() {

				requestAnimationFrame( animate );
				if(consent){

				// const delta = clock.getDelta();

				// mixer.update( delta );

				controls.update();

				// stats.update();

				renderer.render( scene, camera );}

			}


		</script>

	</body>

</html>
